PX4可以划分成四个层次：
    1.应用程序的API：这个接口提供给开发人员，比如使用ROS(实时操作系统)或DroneAPI(DroneAPI是一个用于控制无人机的Python库，可以单独的运行在机载电脑或者其他设备上，通过串口或者无线的方式与飞控板通信)，这一层旨在尽可能的精简、扁平及隐藏其复杂性。
    2.应用程序框架: 这是为操作基础飞行控制的默认程序集（节点）。比如旋翼的控制、直升机的控制、固定翼的控制等，还有位置估计、命令控制、导航控制等。
    3.库: 这一层包含了所有的系统库和基本交通控制的函数。比如数学库、控制库、MAV库等等。
    4.操作系统: 最后一层提供操作系统支持，比如任务的调度，硬件驱动程序，网络，UAVCAN和故障安全系统等功能。

飞行控制流程:
    1.用户通过地面站或者遥控器发出模式切换以及摇杆操作对飞行器进行控制，commander根据飞行器的当前状态对用户想要切换到的状态main_state进行判断：是否能够切换到目标状态，确定最终状态。stickmapper见名知意，摇杆映射，参见px4io.c、sensors.cpp文件。
    2.navigator决定飞行器最终会怎么做飞行模式nav_state的转换，以及对应模式下飞机的飞行控制。
    3.位置控制提取local postion(光流+IMU)或global postion(GPS)数据根据导航状态进行串级PID控制。外环输入位置差输出速度，内环输出推力。
    4.姿态控制采用倾转分离的解耦合控制方式，先对齐Z轴再对齐偏航角。同样采用串级PID的控制方式，外环输入姿态角误差，输出姿态角速率，内环最后输出所需的力矩。
    5.mixer混控器根据机型进行力矩分配。根据叶素理论，螺旋桨旋转产生的s升力/扭矩与转速的平方以及拉力系数/扭矩系数相关。构造力矩分配矩阵。
    6.otor_driver驱动电机，控制飞行器飞行。

3个基本模块：
    1. RLT(Return to launch返航控制)模块
    